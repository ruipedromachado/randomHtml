<!DOCTYPE html>
<html>

<head>
	<title></title>
	<style>
		.ce {
			border: 1px solid dimgray;
		}
		p {
			margin: 50px;
		}
	</style>
</head>
<body>
	<p class="ce">
		<textarea id="myTextarea1">

		</textarea>			
	</p>
	<p>
		Copes with complex object with circular references, window object, dom elements and other primitive types. Everything will be flatten.
	</p>
	<p class="ce">
		<textarea id="myTextarea2">
	
		</textarea>
	</p>	
	<p>
		(This object is also available on the console, for real time testing. Use the command 
		<i>console.log(utag_data.utilities.the_flattinator(complex_data_layer_object));</i> 
		to see the result in the console.)
	</p>
	<button style="visibility:hidden">aaaa</button>
</body>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/codemirror.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldgutter.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/tomorrow-night-bright.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/fullscreen.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/codemirror.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/javascript/javascript.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldcode.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldgutter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/brace-fold.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/xml-fold.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/indent-fold.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/markdown-fold.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/comment-fold.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/selection/active-line.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/fullscreen.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/search/searchcursor.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/search/search.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/search/jump-to-line.js"></script>
<script src="the_ultimate_flattinator.js" type="text/javascript"></script>
<script>
	var complex_data_layer_object = {
		a1 : complex_data_layer_object,
		a2 : window,
		a3 : document,
		a4 : this,
		a5 : document.querySelector("button"),
		a6 : null,
		a7 : undefined,
		a8 : [
			complex_data_layer_object,
			window,
			document,
			this,
			document.querySelector("button"),
			null,
			undefined
		],
		"string": "name",
		"number": 1,
		"date": new Date(),
		"n1": 1.1,
		"array": ["1", "2", "3"],
		"complex_array": [{
			"string": "name2",
			"number": 2,
		}, {
			"string": "name1",
			"number": 1,
		}, {
			"string": "name3",
			"number": 3,
		}],
		funct : function () {
			console.log("123");
		},
		t : {
			b : function() {
				console.log("222");
			},
			"array": ["1", "2", "3"],
			"complex_array": [{
				"string": "name2",
				"number": 2,
			}, {
				"string": "name1",
				"number": 1,
			}, {
				"string": "name3",
				"number": 3,
			}]
		},
		cplx: {
			"string": "name",
			"number": 1,
			"date": new Date(),
			"n2": 1.1,
			"array": [
				"1", 
				"2", 
				"3", 
				new Date(), { 
					data : "123",
					arr : ["a", "b"],
					complex: {
						d : 1,
						s : 2,
						"n3" : 1.1
					}
				}
			],
			"complex_array": [{
				"string": "name2",
				"number": 2,
			}, {
				"string": "name1",
				"number": 1,
			}, {
				"string": "name3",
				"number": 3,
			}]
		},
	};
	console.log(utag_data.utilities.the_flattinator(complex_data_layer_object));
	var sample2 = 'var flattened_data_layer_object = {\n' +
		'	flattened.total_flattened_properties : 51\n' +
		'	flattened.a6 : null\n' +
		'	flattened.a8.array_item_5 : null\n' +
		'	flattened.string : "name"\n' +
		'	flattened.number : 1\n' +
		'	flattened.date : Sat Sep 21 2019 01:34:42 GMT+0100 (British Summer Time)\n' +
		'	flattened.date_date_to_string : "Sat Sep 21 2019 01:34:42 GMT+0100 (British Summer Time)"\n' +
		'	flattened.n1 : 1.1\n' +
		'	flattened.array.array_item_0 : 1\n' +
		'	flattened.array.array_item_1 : 2\n' +
		'	flattened.array.array_item_2 : 3\n' +
		'	flattened.complex_array.array_item_0.string : "name2"\n' +
		'	flattened.complex_array.array_item_0.number : 2\n' +
		'	flattened.complex_array.array_item_1.string : "name1"\n' +
		'	flattened.complex_array.array_item_1.number : 1\n' +
		'	flattened.complex_array.array_item_2.string : "name3"\n' +
		'	flattened.complex_array.array_item_2.number : 3\n' +
		'	flattened.t.array.array_item_0 : 1\n' +
		'	flattened.t.array.array_item_1 : 2\n' +
		'	flattened.t.array.array_item_2 : 3\n' +
		'	flattened.t.complex_array.array_item_0.string : "name2"\n' +
		'	flattened.t.complex_array.array_item_0.number : 2\n' +
		'	flattened.t.complex_array.array_item_1.string : "name1"\n' +
		'	flattened.t.complex_array.array_item_1.number : 1\n' +
		'	flattened.t.complex_array.array_item_2.string : "name3"\n' +
		'	flattened.t.complex_array.array_item_2.number : 3\n' +
		'	flattened.cplx.string : "name"\n' +
		'	flattened.cplx.number : 1\n' +
		'	flattened.cplx.date : Sat Sep 21 2019 01:34:42 GMT+0100 (British Summer Time)\n' +
		'	flattened.cplx.date_date_to_string : "Sat Sep 21 2019 01:34:42 GMT+0100 (British Summer Time)"\n' +
		'	flattened.cplx.n2 : 1.1\n' +
		'	flattened.cplx.array.array_item_0 : 1\n' +
		'	flattened.cplx.array.array_item_1 : 2\n' +
		'	flattened.cplx.array.array_item_2 : 3\n' +
		'	flattened.cplx.array.array_item_3 : Sat Sep 21 2019 01:34:42 GMT+0100 (British Summer Time)\n' +
		'	flattened.cplx.array.array_item_3_date_to_string : "Sat Sep 21 2019 01:34:42 GMT+0100 (British Summer Time)"\n' +
		'	flattened.cplx.array.array_item_4.data : 123\n' +
		'	flattened.cplx.array.array_item_4.arr.array_item_0 : "a"\n' +
		'	flattened.cplx.array.array_item_4.arr.array_item_1 : "b"\n' +
		'	flattened.cplx.array.array_item_4.complex.d : 1\n' +
		'	flattened.cplx.array.array_item_4.complex.s : 2\n' +
		'	flattened.cplx.array.array_item_4.complex.n3 : 1.1\n' +
		'	flattened.cplx.complex_array.array_item_0.string : "name2"\n' +
		'	flattened.cplx.complex_array.array_item_0.number : 2\n' +
		'	flattened.cplx.complex_array.array_item_1.string : "name1"\n' +
		'	flattened.cplx.complex_array.array_item_1.number : 1\n' +
		'	flattened.cplx.complex_array.array_item_2.string : "name3"\n' +
		'	flattened.cplx.complex_array.array_item_2.number : 3\n' +
		'};\n';
	var sample1 = 'var complex_data_layer_object = {\n' +
				'    a1 : complex_data_layer_object,\n' +
				'    a2 : window,\n' +
				'    a3 : document,\n' +
				'    a4 : this,\n' +
				'    a5 : document.querySelector("button"),\n' +
				'    a6 : null,\n' +
				'    a7 : undefined,\n' +
				'    a8 : [\n' +
				'        complex_data_layer_object,\n' +
				'        window,\n' +
				'        document,\n' +
				'        this,\n' +
				'        document.querySelector("button"),\n' +
				'        null,\n' +
				'        undefined\n' +
				'    ],\n' +
				'    "string": "name",\n' +
				'    "number": 1,\n' +
				'    "date": new Date(),\n' +
				'    "n1": 1.1,\n' +
				'    "array": ["1", "2", "3"],\n' +
				'    "complex_array": [{\n' +
				'        "string": "name2",\n' +
				'        "number": 2,\n' +
				'    }, {\n' +
				'        "string": "name1",\n' +
				'        "number": 1,\n' +
				'    }, {\n' +
				'        "string": "name3",\n' +
				'        "number": 3,\n' +
				'    }],\n' +
				'    funct : function () {\n' +
				'        console.log("123");\n' +
				'    },\n' +
				'    t : {\n' +
				'        b : function() {\n' +
				'            console.log("222");\n' +
				'        },\n' +
				'        "array": ["1", "2", "3"],\n' +
				'        "complex_array": [{\n' +
				'            "string": "name2",\n' +
				'            "number": 2,\n' +
				'        }, {\n' +
				'            "string": "name1",\n' +
				'            "number": 1,\n' +
				'        }, {\n' +
				'            "string": "name3",\n' +
				'            "number": 3,\n' +
				'        }]\n' +
				'    },\n' +
				'    cplx: {\n' +
				'        "string": "name",\n' +
				'        "number": 1,\n' +
				'        "date": new Date(),\n' +
				'        "n2": 1.1,\n' +
				'        "array": [\n' +
				'            "1", \n' +
				'            "2", \n' +
				'            "3", \n' +
				'            new Date(), { \n' +
				'                data : "123",\n' +
				'                arr : ["a", "b"],\n' +
				'                complex: {\n' +
				'                    d : 1,\n' +
				'                    s : 2,\n' +
				'                    "n3" : 1.1\n' +
				'                }\n' +
				'            }\n' +
				'        ],\n' +
				'        "complex_array": [{\n' +
				'            "string": "name2",\n' +
				'            "number": 2,\n' +
				'        }, {\n' +
				'            "string": "name1",\n' +
				'            "number": 1,\n' +
				'        }, {\n' +
				'            "string": "name3",\n' +
				'            "number": 3,\n' +
				'        }]\n' +
				'    },\n' +
				'};\n';
	var editor1 = CodeMirror.fromTextArea(document.getElementById("myTextarea1"), {
    	styleActiveLine: true,
    	lineWrapping: true,
    	extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
		lineNumbers: true,
		foldGutter: true,
		gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
		autoCloseBrackets: true,
		theme: "tomorrow-night-bright",
		extraKeys: {
			"F11": function(cm) {
			cm.setOption("fullScreen", !cm.getOption("fullScreen"));
			},
			"Esc": function(cm) {
			if (cm.getOption("fullScreen")) cm.setOption("fullScreen", false);
			}
		}
	});
	var editor2 = CodeMirror.fromTextArea(document.getElementById("myTextarea2"), {
    	styleActiveLine: true,
    	lineWrapping: true,
    	extraKeys: {"Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); }},
		lineNumbers: true,
		foldGutter: true,
		gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
		autoCloseBrackets: true,
		theme: "tomorrow-night-bright",
		extraKeys: {
			"F11": function(cm) {
			cm.setOption("fullScreen", !cm.getOption("fullScreen"));
			},
			"Esc": function(cm) {
			if (cm.getOption("fullScreen")) cm.setOption("fullScreen", false);
			}
		}
	});

	var doc1 = editor1.getDoc();
	doc1.setValue(sample1);
	//doc1.setOption("theme", "tomorrow-night-bright");

	var doc2 = editor2.getDoc();
    doc2.setValue(sample2);
	//doc2.setOption("theme", "tomorrow-night-bright");

</script>
</html>